---
title: "Final ENM Script for S. tortuosus"
author: "Natalie Love"
date: "8/30/2020"
output: html_document
---

##Load packages
```{r}
library(spThin)
library(dismo)
library(maptools)
library(rgdal)
library(raster)
library(sp)
library(ENMTools)
library(gtools)
library(rJava)
library(tidyverse)
library(sf)
library(gstat) #variogram
library(RStoolbox) #raster PCA
```
##Read in occurence data and remove spatial duplicates
These are from my herbarium dataset and lack duplicates (in time and space but not just space), those that do not have a exact DOY, those that have an error radius less than 4km, those that are in flower. These represent specimens that fall within the boundaries of the California Floristic Province (CFP). Of the 784 in the complete dataset, only six occurrences did not fall within the boundaries of the CFP. Those have already been removed.
```{r}
tort_occ <- read.csv(file = "data/tort_occ_cfp.csv")
head(tort_occ)

#remove columns that are not spatial coordinates
tort_occ <- tort_occ[,1:2]
head(tort_occ)

#remove spatial duplicates, removes 44 occurences with exactly the same coordinates
tort_occ_unique <- unique.data.frame(tort_occ)
```

##Read in climate data (rasters)


#1. Thin occurrences
Need to thin occurences to reduce sampling bias. I used the package spThin, which requires a user inputted nearest neighbor distance. The package will randomly chose a point to thin in a pair of points within the nearest neighbor distance. Ideally, thinning occurences will reduce autocorrelation among occurrences in environmental space, but retain enough occurrences to build a robust model. To determine the optimum nearest neighbor distance, I constructed variograms using PC values for the environmental climate layers.

###